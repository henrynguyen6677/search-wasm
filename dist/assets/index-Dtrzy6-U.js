(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function y(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=y(t);fetch(t.href,r)}})();const b=100;let c=1,g=0,k,p=[];function T(){const h=document.getElementById("file-input"),m=document.getElementById("pattern-input"),y=document.getElementById("search-button"),s=document.getElementById("status"),t=document.getElementById("file-list"),r=document.getElementById("results-container"),d=document.getElementById("pagination-controls"),C=document.getElementById("progress-container"),w=document.getElementById("progress-bar");function I(e){r.innerHTML="",c=e;const o=(e-1)*b,n=o+b,l=p.slice(o,n);let E="";l.forEach((i,a)=>{const f=o+a+1,L=i.replace(k,'<mark class="highlight">$&</mark>');E+=`<div class="result-line"><span class="line-number">${f}.</span><span class="line-content">${L}</span></div>`}),r.innerHTML=E,r.scrollTop=0}function P(){if(d.innerHTML="",g===0)return;const e=Math.ceil(g/b),o=document.createElement("span");o.className="text-sm text-gray-400",o.textContent=`Page ${c} / ${e}`;const n=document.createElement("button");n.textContent="Previous",n.className="pagination-btn",n.disabled=c===1,n.onclick=()=>{c>1&&(I(c-1),P())};const l=document.createElement("button");l.textContent="Next",l.className="pagination-btn",l.disabled=c===e,l.onclick=()=>{c<e&&(I(c+1),P())},d.append(n,o,l)}async function B(){const e=h.files,o=m.value;if(r.innerHTML="",d.innerHTML="",p=[],g=0,w.style.width="0%",C.classList.add("hidden"),e.length===0||!o){s.textContent="Error: Please select files and enter a pattern.";return}try{k=new RegExp(o,"g")}catch{s.textContent="Error: Invalid Regex pattern.";return}s.textContent=`Initializing ${e.length} parallel worker threads...`;const n=Array(e.length).fill(0);C.classList.remove("hidden");function l(){if(n.length===0)return;const i=n.reduce((a,f)=>a+f,0)/n.length;w.style.width=`${i}%`}const E=Array.from(e).map((i,a)=>new Promise((f,L)=>{const u=new Worker(new URL("/assets/worker-BDX8w5W0.js",import.meta.url),{type:"module"});u.onmessage=v=>{const{type:x,matches:M,text:N,progress:$}=v.data;x==="ready"?u.postMessage({type:"processFile",payload:{file:i,pattern:o}}):x==="progress"?(console.log(`Worker ${a} progress: ${$}%`),n[a]=$,l()):x==="done"?(n[a]=100,l(),f(M),u.terminate()):x==="error"&&(L(new Error(N)),u.terminate())},u.onerror=v=>{L(v),u.terminate()}}));try{s.textContent=`Processing ${e.length} files in parallel...`;const i=await Promise.all(E);s.textContent="Aggregating results...",w.style.width="100%";for(const a of i)p=p.concat(a);g=p.length,g>0?(I(1),P(),s.textContent=`Done! Found ${g} total matches.`):s.textContent="No matches found."}catch(i){console.error("Error during parallel processing:",i),s.textContent="An error occurred during processing."}finally{setTimeout(()=>{C.classList.add("hidden")},1e3)}}y.addEventListener("click",B),y.addEventListener("keydown",e=>{console.log(e.key),e.key==="Enter"&&B()}),h.addEventListener("change",()=>{t.innerHTML="";const e=h.files;if(e.length>0){s.textContent=`Selected ${e.length} files.`;for(const o of e){const n=document.createElement("span");n.className="file-item",n.textContent=o.name,t.appendChild(n)}}})}document.addEventListener("DOMContentLoaded",T);
